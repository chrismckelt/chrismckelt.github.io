I"U<p>ThreadPool.QueueUserWorkItem(new WaitCallback(LoadUsers));</p>

<p>private void LoadUsers(Object stateInfo)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var site = new SPSite(testHarnessSettings.Url);

 var web = site.OpenWeb();

  foreach(SPUser user in web.AllUsers)

  {

   if (usersListBox.InvokeRequired)

   {

         usersListBox.Invoke(new MethodInvoker(delegate { usersListBox.Items.Add((user.LoginName)); }));

   }
</code></pre></div></div>

<p>Â </p>

<p>http://weblogs.asp.net/justin_rogers/articles/126345.aspx</p>
:ET
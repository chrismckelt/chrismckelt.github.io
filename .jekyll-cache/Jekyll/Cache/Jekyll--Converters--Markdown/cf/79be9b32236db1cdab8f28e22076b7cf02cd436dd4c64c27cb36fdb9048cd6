I".<p><strong>SharePoint main objects</strong></p>

<p>SPSite = Site Collection SPWeb = Site Web</p>

<p>SPSite siteCollection = new SPSite(â€œhttp://localhost/sites/sitenameâ€); SPWeb web = siteCollection.OpenWeb();</p>

<p><strong>Features</strong></p>

<p>Features define a mechanism for defining site elements and adding them to a target site or site collection through a process called <em>feature activation</em></p>

<p>An example feature</p>

<p>Â &lt;Feature Id=â€œ6AA03A00-02B5-4d83-A041-1CEB0DE9EF9Eâ€ Title=â€œChris Document Managerâ€ Description=â€œTest descriptionâ€ Version=â€œ1.0.0.0â€  Scope=â€œWebâ€ ImageUrl=â€œTestImage.gifâ€ ReceiverAssembly=â€œDocumentManager, Version=1.0.0.0, Culture=neutral, PublicKeyToken=52cb0cd67d773ef7â€ ReceiverClass=â€œDocumentManager.FeatureReceiverâ€ xmlns=â€œhttp://schemas.microsoft.com/sharepoint/â€&gt; &lt;ElementManifests&gt; &lt;ElementManifest Location=â€œelements.xmlâ€ /&gt; &lt;/ElementManifests&gt; &lt;/Feature&gt;</p>

<p><strong>Elements</strong></p>

<p>Â The element types that can be defined by a feature include</p>

<ul>
  <li>Menu commands</li>
  <li>Link commands</li>
  <li>Pages templates</li>
  <li>Page instances</li>
  <li>List definitions</li>
  <li>List instances</li>
  <li>Event handlers</li>
  <li>Workflows</li>
</ul>

<p>Â  &lt;Elements xmlns=â€œhttp://schemas.microsoft.com/sharepoint/â€&gt; &lt;CustomAction  Id=â€œSiteActionsToolbarâ€ GroupId=â€œSiteActionsâ€ Location=â€œMicrosoft.SharePoint.StandardMenuâ€ Sequence=â€œ100â€ Title=â€œHello Worldâ€ Description=â€œA custom menu item added using a featureâ€ ImageUrl=â€œ_layouts/images/crtsite.gifâ€ &gt; Â Â Â Â Â  &lt;UrlAction Url=â€œhttp://msdn.microsoft.comâ€/&gt; &lt;/CustomAction&gt; &lt;/Elements&gt;</p>

<p><strong>Configuration Elements</strong></p>

<p>Â </p>

<p>&lt;configuration&gt; &lt;configSections&gt; &lt;sectionGroup name=â€œSharePointâ€&gt; &lt;section name=â€œSafeControlsâ€ type=â€â€/&gt; &lt;section name=â€œRuntimeFilterâ€ type=â€â€/&gt; &lt;section name=â€œWebPartLimitsâ€ type=â€â€/&gt; &lt;section name=â€œWebPartCacheâ€ type=â€â€/&gt; &lt;section name=â€œWebPartWorkItemâ€ type=â€â€/&gt; &lt;section name=â€œWebPartControlsâ€ type=â€â€/&gt; &lt;section name=â€œSafeModeâ€ type=â€â€/&gt; &lt;section name=â€œMergedActionsâ€ type=â€â€/&gt; &lt;section name=â€œPeoplePickerWildCardsâ€ type=â€â€/&gt; &lt;section name=â€œSafeControlsâ€ type=â€â€/&gt; &lt;section name=â€œSafeControlsâ€ type=â€â€/&gt; &lt;/sectionGroup&gt; &lt;/configSections&gt; &lt;SharePoint&gt; <SafeMode></SafeMode> <WebPartLimits></WebPartLimits> <WebPartCache></WebPartCache> <WebPartControls></WebPartControls> <SafeControls></SafeControls> <PeoplePickerWildCards></PeoplePickerWildCards> <MergedActions></MergedActions> <BlobCache></BlobCache> <RuntimeFilter></RuntimeFilter> &lt;/SharePoint&gt; &lt;/configuration&gt;</p>

<p><strong>SPVirtualPathProvider</strong></p>

<p>SPVirtualPathProvider allows files to be stored in the database â€“ a term referred to as â€˜ung_hosted_â€™</p>

<p>It can also retrieve pages from the file system â€˜G_hosted_â€™ and pass them to the asp.net aspx page parser</p>

<p><strong>Pages Types</strong></p>

<p>Site Pages</p>

<ul>
  <li>Support customisation</li>
  <li>Have web parts and webpart zones</li>
</ul>

<p>Application Pages</p>

<ul>
  <li>Deployed as physical files (aspx) of the front end web server in the following location</li>
  <li>C: \program files \common files \microsoft shared \web server extensions \12 \template \layouts</li>
  <li>Inherit from LayoutsPageBase</li>
</ul>

<p><strong>Debugging WSS Components</strong></p>

<p>&lt;configuration&gt; &lt;SharePoint&gt; &lt;SafeMode CallStack=â€œtrueâ€/&gt; &lt;/SharePoint&gt; &lt;system.web&gt; &lt;customErrors mode=â€œOffâ€/&gt; &lt;compilation debug=â€œtrueâ€/&gt; &lt;/system.web&gt; &lt;/configuration&gt;</p>

<p><strong>SPFile</strong></p>

<p>SPWeb site = SPContext.Current.Web; SPFile homePage = site.GetFile(â€œdefault.aspxâ€)</p>

<p><strong>Default.master</strong></p>

<p>Resides in c: \program files \common files \microsoft shared \web server  extensions \12 \template \global \default.master</p>

<p><strong>Web Part Gallery</strong></p>

<p>Document library that contains serialised web parts.Â  There web parts have a <em>.webpart</em> extension (older WSS 2.0 were serialised using an old version with a .dwp extension)</p>

<p>Editor Web Part has 2 abstract methods to override to implement changes â€“ <em>ApplyChanges</em> &amp; <em>SynchChanges</em></p>

<p><em>IWebPartField</em> interface is implemented by many WSS web parts â€“ ie List View &amp; Image</p>

<p>HTTPHandler endpoints are the preferred data source for AJAX applications in which data is returned in a simple XML, text or JSON format representing the data query. This is a subset of the REST architecture pattern (Representational State Transfer).</p>

<p>Â IHttpAsynchHandler is the preferred interface for handlers that need long running tasks.</p>

<p><strong>Lists &amp; Content Types</strong></p>

<p>The create page contains built in list types broken out into sections including <em>libraries</em>, <em>communications</em>, <em>tracking</em> and <em>custom lists</em></p>

<p>WSS List definitions</p>

<ul>
  <li>Document library</li>
  <li>Form library</li>
  <li>Wiki page library</li>
  <li>Picture library</li>
  <li>Announcements</li>
  <li>Contacts</li>
  <li>Discussions</li>
  <li>Links</li>
  <li>Calendar</li>
  <li>Tasks</li>
  <li>Project tasks</li>
  <li>Issue tracking</li>
  <li>Custom list</li>
</ul>

<p>WSS list bast types</p>

<ul>
  <li>Standard lists = 0</li>
  <li>Document libraries = 1</li>
  <li>Discussion forums = 3</li>
  <li>Vote/Survey lists = 4</li>
  <li>Issue lists = 5</li>
</ul>

<p>Â  Lists store their data in columns (also called fields).Â  WSS 3.0 introduces site columns which are reusable fields</p>

<p>To have a custom field type recognised a <em>Field Schema</em> file is added in a CAML based syntax into a well known location.</p>

<p>Â Field types are defined in files name <em>fldtypes_companyName.xml</em> that must be deployed in <em>TEMPLATE\XML</em> directory</p>

<p>Â SPQuery query = new SPQuery(); query.ViewFields = @â€<FieldRef Name="Title"></FieldRef><FieldRef Name="Expires"></FieldRef>â€; query.Query = @â€<Where> <Lt> <FieldRef Name="Expires"></FieldRef> <Value Type="DateTime"> <Today></Today></Value> </Lt> </Where>â€; //NB://Â  <Where><operator><operand></operand><operand></operand></operator></Where></p>

<table>
  <tbody>
    <tr>
      <td>SPQuery object returns a SPListItemCollection</td>
      <td>Â </td>
      <td>Â  SPSiteDataQuery returns a datatable</td>
    </tr>
  </tbody>
</table>

<p>The built in columns are defined in the build-in fields feature</p>

<p><a href="http://blogs.msdn.com/andrew_may/archive/2006/05/24/SharePointBeta2WhatAreContentTypes.aspx" title="http://blogs.msdn.com/andrew_may/archive/2006/05/24/SharePointBeta2WhatAreContentTypes.aspx">Content Types</a>Â Â Â Â Â Â Â Â Â Â Â  â€”&gt;Â Â  <a href="http://blogs.msdn.com/andrew_may/archive/2006/06/24/SharePointBeta2WhatAreContentTypeIDs.aspx" title="http://blogs.msdn.com/andrew_may/archive/2006/06/24/SharePointBeta2WhatAreContentTypeIDs.aspx">Content Type Ids</a></p>

<p>Content types define underlying schema for either an item oin a list or a document in a document library.</p>

<p>Content types are either list based or document based.</p>

<p>A forms library is designed to store XML documents created from InfoPath forms.</p>

<p>A schema file must define content type references and its own separate data scheme as well as views and forms.</p>

<p>Create a custom document library in code â€“ with 4 extended fields</p>

<p>Â </p>

<p>const string LIBRARY_NAME = â€œBeazleyTradeDocumentLibraryâ€;  SPSite siteCollection = new SPSite(â€œhttp://localhost:334â€);SPWeb web = siteCollection.OpenWeb();if (!ListExists(web.Lists, LIBRARY_NAME)){Guid listId = siteCollection.RootWeb.Lists.Add(LIBRARY_NAME, â€œBeazley Trade Document Libraryâ€, SPListTemplateType.DocumentLibrary);SPList list = web.Lists[listId];list.Fields.Add(â€œBTProductIdâ€, SPFieldType.Number, true);list.Fields.Add(â€œBTDocumentVersionNoâ€, SPFieldType.Number, true);list.Fields.Add(â€œBTProductNameâ€, SPFieldType.Text, false);list.Fields.Add(â€œTemplateTypeâ€, SPFieldType.Text, false);SPField btProductIdField = list.Fields[â€œBTProductIdâ€];btProductIdField.ShowInDisplayForm = true;btProductIdField.ShowInEditForm = true;btProductIdField.ShowInListSettings = true;btProductIdField.ShowInNewForm = true;btProductIdField.ShowInViewForms = true;SPView defaultView = list.Views[0];defaultView.ViewFields.Add(btProductIdField);defaultView.Update();list.ContentTypesEnabled = false;list.OnQuickLaunch = true;list.EnableAttachments = false;list.EnableVersioning = false;list.NoCrawl = true;list.Update();}</p>

<p>Â </p>

<p>Â </p>

<p><strong>Office Open XML</strong></p>

<p>Office Open XML file formats. Top level file such as Hello.docx is know as a <em>package</em>.</p>

<p>Inside a package are 2 kinds of internal components: <em>parts</em> and <em>items</em></p>

<p>In general, parts contain content and items contain metadata describing the parts.</p>

<p>Items can be further subdivided into <em>relationship items</em> and <em>content-type items</em></p>

<p>A part is an internal component containing content that is presisted inside the package.</p>

<p>The majority of parts are simple text files serialised as XML with an associated schema.</p>

<p>Open office xml file formats use relationships to define associations between a source and a target part.</p>

<p>A package relationship defines an association between the top level package and a part.</p>

<p>A part relationship defines an association between a parent part and a child part.</p>

<p>Â </p>

<p><em>Site definition</em> â€“ is the top level component in WSS that aggregates smaller, more modular definitions to create a complete site template that can be used to provision sites.</p>

<p>Site definitions are deployed within the 12\TEMPLATE\SITETEMPLATES directory and are referenced in the 12\TEMPLATE\<culture>\\XML directory WEBTEMP.XML files where the <culture> folder is the locale identifier 12\\TEMPLATE\\1033\\XML for US English</culture></culture></p>

<p>Global site definitio - provides a common repository for site provision instructions required by every site definition.</p>

<p>The ONET.xml file serves as a high level manifest for the site definition and references the components that are to be used A feature can also be used to attach one or more other features to a site definition through a technique called <em>feature stapling</em> Localisation in WSS is based on language packs that are deployed as solutions packages</p>

<p>A _solution package_is a compressed .cab file with a .wsp extension containing the componentsto be deployed on a target web server. The .wsp file for a solutions package can be built using the MAKECAB operations system utilityÂ  by reading the definition from a .ddf file.</p>

<p>The .ddf file defines the output structure of the .wsp file by referencing each file in its source location and its destination location in the .wsp file.</p>

<p>The metadata for a solution package is maintained in a file named manifest.xml that must be added to the root of the .wsp file.Â  It is the manifest.xml that tells the WSS runtime which template files to copy into the WSS system directories.</p>

<p>WSS permission definitions</p>

<ol>
  <li>Environment permission</li>
  <li>Security Permission</li>
  <li>AspNetHostingPermission</li>
  <li>WebPermission</li>
</ol>

<p>SPSecurity allows code to run with higher priviledges</p>

<p>Â </p>

<p>SPSecurity.RunWithElevitedPrivaledges(</p>

<p>delegate{// code run as SharePoint\System}</p>

<p>)</p>
:ET
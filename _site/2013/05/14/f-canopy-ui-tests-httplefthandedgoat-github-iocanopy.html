<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F# Canopy UI tests -- http://lefthandedgoat.github.io/canopy/ | Chris McKelt</title>

    <link href="/assets/css/rouge-github.css" rel="stylesheet">
    <link href="/assets/css/custom.css" rel="stylesheet">

    <link rel="alternate" type="application/atom+xml" title="Chris McKelt’s blog" href="/feed.xml">

    <link rel="canonical" href="http://0.0.0.0:4000/2013/05/14/f-canopy-ui-tests-httplefthandedgoat-github-iocanopy.html" />
  </head>
  <body>
    <header>
  <span class="font-semibold text-xl tracking-tight">
    mckelt.com
  </span>
  <div class="follow-btns">
    <a class="btn btn-twitter-round" href="https://twitter.com/chris_mckelt" target="_blank" rel="noopener noreferrer" alt="Twitter" title="Me on Twitter"><span class="sr-only">Twitter</span></a>
    <a class="btn btn-github-round" href="https://github.com/chrismckelt/" target="_blank" rel="noopener noreferrer" alt="GitHub" title="Me on GitHub"><span class="sr-only">GitHub</span></a>
    <a class="btn btn-rss-round" href="/feed.xml" target="_blank" alt="RSS" title="RSS"><span class="sr-only">RSS</span></a>
  </div>
</header>

    <nav>
      <ul>
        <li><a href="/">Posts</a></li>
        <li><a href="/about">About</a></li>
        <li><a href="/talks">Talks</a></li>
        <li><a href="/contact">Contact</a></li>
      </ul>
    </nav>

    <main>
      <article>
        <h2>F# Canopy UI tests -- http://lefthandedgoat.github.io/canopy/</h2>
        <p class="publish-date">
  Published: <time datetime="2013-05-14">May 14, 2013</time>
  
  <br />
  
  By: <a rel="author"
    href="https://www.linkedin.com/in/"
    title="">
       
  </a>
</p>

        <p>namespace RegressionTests</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>open System
open System.Configuration
open runner
open canopy
open configuration
open reporters
open QuoteHelper

module QuoteSiteTests =

    let runTest = (

        start chrome
        let mainBrowser = browser
        elementTimeout &lt;- 15.0
        compareTimeout &lt;- 15.0

        let \_testpage =             ConfigurationManager.AppSettings.\["AolSiteUrl"\]
        let \_username =             ConfigurationManager.AppSettings.\["AolChallengerId"\]
        let \_password =             ConfigurationManager.AppSettings.\["AolPassword"\]
        let \_passwordChangeToThis = ConfigurationManager.AppSettings.\["AolPasswordChangeToThis"\]
        let \_includePasswordChangeTest = ConfigurationManager.AppSettings.\["IncludePasswordChangeTest"\]
        let \_quickSearchText = ConfigurationManager.AppSettings.\["QuickSearchText"\]
        let \_quickSearchFindInvestor = ConfigurationManager.AppSettings.\["QuickSearchFindInvestor"\]
        let \_path = ConfigurationManager.AppSettings.\["OutputTestResults"\]

        QuoteHelper.deleteFiles \_path "" true

        for file in System.IO.Directory.EnumerateFiles(\_path) do
            let tempPath = System.IO.Path.Combine(\_path, file)
            System.IO.File.Delete(tempPath)

        context ("Testing :: eQuote - " + \_testpage + "/Quote")

        before (fun \_ -&gt; 
              describe "Starting test"
              url (\_testpage + "/Quote")
            )
       
        ntest "Login" (fun \_ -&gt;
            describe ("Login with " + \_username)
            url \_testpage
            "#userId" &lt;&lt; \_username
            "#password" &lt;&lt;  \_password
            click ".submit"
          //  on (\_testpage + "/Secure/Home/")
        )

        ntest "GIP Quote - Fixed Term" (fun \_ -&gt;
                describe "Creating GIP quote – fixed 3 year"
                js "$('input:radio\[name=NewPolicyType\]:first').attr('checked', true);" |&gt; ignore
                click "#btnContinue1"
                sleep 5
                let setQuote = QuoteHelper.createQuoteTerm "100000" "Monthly" "3"
                js setQuote |&gt; ignore
                click "#btnRunQuote"
                sleep 5
                click "#btnSaveQuote"
                sleep 3
                let linkText = read "#yourQuoteId"
                describe linkText
                screenshot \_path linkText |&gt; ignore
                )

        ntest "GIP quote – life" (fun \_ -&gt;
                describe "Creating GIP quote – life"
                js "$('input:radio\[name=NewPolicyType\]::nth(1)').attr('checked', true);" |&gt; ignore
                click "#btnContinue1"
                sleep 5
                js " $('input:radio\[name=ProductTerm\]::nth(1)').click();" |&gt; ignore
                sleep 1
                let setQuote = QuoteHelper.createQuoteLife "100000" "Monthly" 
                js setQuote |&gt; ignore
                sleep 1
                js "$('#InitialCommissionRate').val('0');" |&gt; ignore
                click "#btnRunQuote"
                sleep 5
                click "#btnSaveQuote"
                sleep 3
                let linkText = read "#yourQuoteId"
                describe linkText
                screenshot \_path linkText |&gt; ignore
                )

        ntest "GA Quote - Fixed Term" (fun \_ -&gt;
                describe "Creating Fee for service annuity quote - FIXED"
                js "$('input:radio\[name=NewPolicyType\]:first').attr('checked', true);" |&gt; ignore
                click "#btnContinue1"
                sleep 5
                let setQuote = QuoteHelper.createQuoteTerm "100000" "Monthly" "3"
                js setQuote |&gt; ignore
                sleep 1
                js "$('#InitialCommissionRate').val('0.0055');" |&gt; ignore
                click "#btnRunQuote"
                sleep 5
                click "#btnSaveQuote"
                sleep 3
                let linkText = read "#yourQuoteId"
                describe linkText
                screenshot \_path linkText |&gt; ignore
                )

        ntest "GA quote – life" (fun \_ -&gt;
                describe "Creating GA quote – life"
                js "$('input:radio\[name=NewPolicyType\]::nth(1)').attr('checked', true);" |&gt; ignore
                click "#btnContinue1"
                sleep 5
                js " $('input:radio\[name=ProductTerm\]::nth(1)').click();" |&gt; ignore
                sleep 1
                let setQuote = QuoteHelper.createQuoteLife "100000" "Yearly" 
                js setQuote |&gt; ignore
                sleep 1
                js "$('#InitialCommissionRate').val('0');" |&gt; ignore
                click "#btnRunQuote"
                sleep 5
                click "#btnSaveQuote"
                sleep 3
                let linkText = read "#yourQuoteId"
                describe linkText
                screenshot \_path linkText |&gt; ignore
                )

        ntest "GreenId Test" (fun \_ -&gt;
                describe "GreenId Test"
                js "$('input:radio\[name=NewPolicyType\]::nth(1)').attr('checked', true);" |&gt; ignore
                click "#btnContinue1"
                sleep 5
                js " $('input:radio\[name=ProductTerm\]::nth(1)').click();" |&gt; ignore
                sleep 1
                let setQuote = QuoteHelper.createQuoteLife "100000" "Yearly" 
                js setQuote |&gt; ignore
                sleep 1
                js "$('#InitialCommissionRate').val('0');" |&gt; ignore
                click "#btnRunQuote"
                sleep 5
                click "#btnSaveQuote"
                sleep 3
                let linkText = read "#yourQuoteId"
                describe linkText
                click "#btnApply"
                sleep 5
                js QuoteHelper.greenId |&gt; ignore
                sleep 1
                click "#InvestorDetails\_IdentityVerification\_CheckId"
                screenshot \_path ("GreenId -" + linkText )|&gt; ignore
                )

        run ()
        quit mainBrowser

)
</code></pre></div></div>

<p>namespace RegressionTests</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>module QuoteHelper =

    let createQuoteTerm amount paymentFrequency term = (
                                         @"  $('#InvestorDetails\_Title').val('Mr');
                                        $('#InvestorDetails\_GivenNames').val('test');
                                        $('#InvestorDetails\_Surname').val('client');
                                        $('#InvestorDetails\_DateOfBirth\_day').val(1);
                                        $('#InvestorDetails\_DateOfBirth\_month').val(1);
                                        $('#InvestorDetails\_DateOfBirth\_year').val(1937);
                                        $('#InvestmentAmount').val(" + amount + ");
                                        $('#InvestmentAmount\_editor').val('$100,000.00');
                                        $('#PaymentFrequency').val('" + paymentFrequency + "');
                                        $('#Term').val('" + term + "');
                                        $('#InitialCommissionRate').val('0');
                                        $('#Indexation').val('ZeroPercent');
                                        $('#OngoingCommissionRate').val('0.00550');
                                        $('#ResidualCapitalValueRate').val('1.00000');
                                        $('#JointInvestorDetails\_Title').val('Mr');
                                        $('#JointInvestorDetails\_GivenNames').val('joint test');
                                        $('#JointInvestorDetails\_Surname').val('client');
                                        $('#JointInvestorDetails\_DateOfBirth\_day').val(31);
                                        $('#JointInvestorDetails\_DateOfBirth\_month').val(12);
                                        $('#JointInvestorDetails\_DateOfBirth\_year').val(1956);")

    let createQuoteLife amount paymentFrequency  = (
                                         @"  $('#InvestorDetails\_Title').val('Mr');
                                        $('#InvestorDetails\_GivenNames').val('test');
                                        $('#InvestorDetails\_Surname').val('client');
                                        $('#InvestorDetails\_DateOfBirth\_day').val(1);
                                        $('#InvestorDetails\_DateOfBirth\_month').val(1);
                                        $('#InvestorDetails\_DateOfBirth\_year').val(1937);
                                        $('#InvestmentAmount').val(" + amount + ");
                                        $('#InvestmentAmount\_editor').val('$100,000.00');
                                        $('#PaymentFrequency').val('" + paymentFrequency + "');
                                        $('#InitialCommissionRate').val('0.0055');
                                        $('#Indexation').val('ZeroPercent');
                                        $('#OngoingCommissionRate').val('0.00550');
                                        $('#ResidualCapitalValueRate').val('1.00000');
                                        $('#JointInvestorDetails\_Title').val('Mr');
                                        $('#JointInvestorDetails\_GivenNames').val('joint test');
                                        $('#JointInvestorDetails\_Surname').val('client');
                                        $('#JointInvestorDetails\_DateOfBirth\_day').val(31);
                                        $('#JointInvestorDetails\_DateOfBirth\_month').val(12);
                                        $('#JointInvestorDetails\_DateOfBirth\_year').val(1956);")

    let greenId = (@"
                    $('#InvestorDetails\_ResidentialAddress\_UnitNumber').val('5');
                    $('#InvestorDetails\_ResidentialAddress\_StreetNumber').val('48');
                    $('#InvestorDetails\_ResidentialAddress\_StreetName').val('Manchester');
                    $('#InvestorDetails\_ResidentialAddress\_Suburb').val('Gymea');
                    $('#InvestorDetails\_ResidentialAddress\_StreetType').val('RD');
                    $('#InvestorDetails\_ResidentialAddress\_State').val('NSW');
                    $('#InvestorDetails\_ResidentialAddress\_Postcode').val(2227);
                
    ")

    let rec deleteFiles srcPath pattern includeSubDirs =

        if not &lt;| System.IO.Directory.Exists(srcPath) then
            let msg = System.String.Format("Source directory does not exist or could not be found: {0}", srcPath)
            raise (System.IO.DirectoryNotFoundException(msg))

            for file in System.IO.Directory.EnumerateFiles(srcPath, pattern) do
            let tempPath = System.IO.Path.Combine(srcPath, file)
            System.IO.File.Delete(tempPath)

            if includeSubDirs then
            let srcDir = new System.IO.DirectoryInfo(srcPath)
            for subdir in srcDir.GetDirectories() do
            deleteFiles subdir.FullName pattern includeSubDirs
</code></pre></div></div>

<p>.csharpcode, .csharpcode pre<br /> {<br /> font-size: small;<br /> color: black;<br /> font-family: consolas, “Courier New”, courier, monospace;<br /> background-color: #ffffff;<br /> /*white-space: pre;*/<br /> }<br /> .csharpcode pre { margin: 0em; }<br /> .csharpcode .rem { color: #008000; }<br /> .csharpcode .kwrd { color: #0000ff; }<br /> .csharpcode .str { color: #006080; }<br /> .csharpcode .op { color: #0000c0; }<br /> .csharpcode .preproc { color: #cc6633; }<br /> .csharpcode .asp { background-color: #ffff00; }<br /> .csharpcode .html { color: #800000; }<br /> .csharpcode .attr { color: #ff0000; }<br /> .csharpcode .alt<br /> {<br /> background-color: #f4f4f4;<br /> width: 100%;<br /> margin: 0em;<br /> }<br /> .csharpcode .lnum { color: #606060; }<br /> .csharpcode, .csharpcode pre<br /> {<br /> font-size: small;<br /> color: black;<br /> font-family: consolas, “Courier New”, courier, monospace;<br /> background-color: #ffffff;<br /> /*white-space: pre;*/<br /> }<br /> .csharpcode pre { margin: 0em; }<br /> .csharpcode .rem { color: #008000; }<br /> .csharpcode .kwrd { color: #0000ff; }<br /> .csharpcode .str { color: #006080; }<br /> .csharpcode .op { color: #0000c0; }<br /> .csharpcode .preproc { color: #cc6633; }<br /> .csharpcode .asp { background-color: #ffff00; }<br /> .csharpcode .html { color: #800000; }<br /> .csharpcode .attr { color: #ff0000; }<br /> .csharpcode .alt<br /> {<br /> background-color: #f4f4f4;<br /> width: 100%;<br /> margin: 0em;<br /> }<br /> .csharpcode .lnum { color: #606060; }<br /></p>

        <p>
  <a href="https://twitter.com/intent/tweet?text=F# Canopy UI tests -- http://lefthandedgoat.github.io/canopy/&amp;url=http://0.0.0.0:4000/2013/05/14/f-canopy-ui-tests-httplefthandedgoat-github-iocanopy.html&amp;via=dzhavatushev" class="btn btn-twitter">
    <span class="label">Share on Twitter</span>
  </a>
</p>

      </article>
    </main>

    <script src="/assets/js/main.js"></script>
  </body>
</html>
